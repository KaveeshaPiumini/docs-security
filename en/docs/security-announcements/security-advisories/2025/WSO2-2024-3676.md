---
title: Security Advisory WSO2-2024-3676/CVE-2024-9517
category: security-announcements
published: "2025-09-23" 
version: "1.0.0"
severity: "Medium"
cvss: "4.9 (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N)"
---

# Security Advisory WSO2-2024-3676/CVE-2024-9517

<p class="doc-info">Published: 2025-09-23</p> 
<p class="doc-info">Updated: 2025-09-23</p>
<p class="doc-info">Version: 1.0.0</p>
<p class="doc-info">Severity: Medium</p>
<p class="doc-info">CVSS Score: 4.9 (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N)</p>
<p class="doc-info">CVE IDs: <a href="https://www.cve.org/CVERecord?id=CVE-2024-9517">CVE-2024-9517</a></p>
---

### AFFECTED PRODUCTS
* WSO2 API Control Plane: 4.5.0
* WSO2 API Management Traffic Manager: 4.5.0
* WSO2 API Manager Universal Gateway: 4.5.0
* WSO2 API Manager: 3.1.0, 3.2.0, 3.2.1, 4.0.0, 4.1.0, 4.2.0, 4.3.0, 4.4.0, 4.5.0
* WSO2 Identity Server: 5.10.0, 5.11.0, 6.0.0, 6.1.0, 7.0.0
* WSO2 Identity Server as Key Manager: 5.10.0
* WSO2 Open Banking AM: 2.0.0
* WSO2 Open Banking IAM: 2.0.0


### OVERVIEW
Refresh token grant continuously works for the user accounts which are blocked by the userstore.


### DESCRIPTION
User accounts that are locked by the user store are still usable to obtain access tokens, if the refresh grant type is enabled. This issue bypasses account lock protections, leading to unauthorized access in scenarios where account locks should prevent token generation.


### IMPACT
This vulnerability may result in unauthorized access, as locked accounts can retrieve access tokens. It poses a risk of privilege escalation or data leakage, depending on the scope of use of the refresh grant type in affected deployments.


### SOLUTION

#### Community Users (Open Source)
Apply the relevant fixes to your product using the public fix(es) provided below.

* [https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/2832](https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/2832)
* [https://github.com/wso2/carbon-identity-framework/pull/7011](https://github.com/wso2/carbon-identity-framework/pull/7011)
* [https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/2840](https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/2840)

If applying the fix or update is not feasible, migrate to the latest unaffected version of the respective WSO2 product(s).

#### Support Subscription Holders

Update your product to the specified update level or a higher update level to apply the fix.

!!! info todo
    **WSO2 Support Subscription Holders may use [WSO2 Updates](https://wso2.com/updates/) in order to apply the fix.**

| Product Name                        | Product Version | U2 Update Level |
| ----------------------------------- | :-------------: | :-------------: |
| WSO2 API Control Plane              |      4.5.0      |       10        |
| WSO2 API Management Traffic Manager |      4.5.0      |        9        |
| WSO2 API Manager Universal Gateway  |      4.5.0      |        9        |
| WSO2 API Manager                    |      3.1.0      |       308       |
| WSO2 API Manager                    |      3.2.0      |       429       |
| WSO2 API Manager                    |      3.2.1      |       49        |
| WSO2 API Manager                    |      4.0.0      |       315       |
| WSO2 API Manager                    |      4.1.0      |       214       |
| WSO2 API Manager                    |      4.2.0      |       149       |
| WSO2 API Manager                    |      4.3.0      |       62        |
| WSO2 API Manager                    |      4.4.0      |       25        |
| WSO2 API Manager                    |      4.5.0      |        9        |
| WSO2 Identity Server as Key Manager |     5.10.0      |       324       |
| WSO2 Identity Server                |     5.10.0      |       331       |
| WSO2 Identity Server                |     5.11.0      |       376       |
| WSO2 Identity Server                |      6.0.0      |       219       |
| WSO2 Identity Server                |      6.1.0      |       205       |
| WSO2 Identity Server                |      7.0.0      |       73        |
| WSO2 Open Banking AM                |      2.0.0      |       357       |
| WSO2 Open Banking IAM               |      2.0.0      |       377       |

In addition to applying the U2 update or public PR, the following configurations should be also added to the `<PRODUCT_HOME>/repository/conf/deployment.toml` to enable the account locking status check at the userstore level during the generation of new access tokens via the refresh grant.

```toml
[oauth.token_renewal]
validate_authenticated_user_for_refresh_grant = true
```
Please note that the account lock status check at the user store level during the refresh grant flow is disabled by default, as enabling it may impact performance.
